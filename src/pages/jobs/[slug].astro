---
import JobDetailSection from '../../components/JobDetailSection.astro';
import Layout from '../../layouts/Layout.astro';

const slug = Astro.params.slug ?? '';
---

<Layout title="Job Details" description="Explore a real job experience.">
  <JobDetailSection slug={slug} server:defer>
    <div slot="fallback" class="stack" aria-live="polite" aria-busy="true">
      <section class="page-hero skeleton-hero">
        <div class="skeleton-pill"></div>
        <div class="skeleton-title"></div>
        <div class="skeleton-line"></div>
        <div class="cta-row">
          <div class="skeleton-button"></div>
          <div class="skeleton-button"></div>
        </div>
      </section>

      <section class="detail-grid">
        {
          Array.from({ length: 6 }).map(() => (
            <article class="panel detail-skeleton">
              <div class="skeleton-title small" />
              <div class="skeleton-line" />
              <div class="skeleton-line medium" />
            </article>
          ))
        }
      </section>
    </div>
  </JobDetailSection>
</Layout>

<style>
  .detail-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 0.9rem;
  }

  .skeleton-hero,
  .detail-skeleton {
    pointer-events: none;
  }

  .skeleton-pill,
  .skeleton-title,
  .skeleton-line,
  .skeleton-button {
    border-radius: 999px;
    background: var(--skeleton-shimmer);
    background-size: 180% 100%;
    animation: shimmer 1.2s ease-in-out infinite;
  }

  .skeleton-pill {
    width: 30%;
    height: 1rem;
  }

  .skeleton-title {
    width: 85%;
    height: 1.35rem;
    border-radius: 10px;
  }

  .skeleton-title.small {
    width: 55%;
    height: 1.2rem;
  }

  .skeleton-line {
    width: 70%;
    height: 1rem;
  }

  .skeleton-line.medium {
    width: 88%;
  }

  .skeleton-button {
    width: 160px;
    height: 2.3rem;
  }

  .detail-skeleton {
    display: grid;
    gap: 0.55rem;
  }

  @keyframes shimmer {
    0% {
      background-position: 100% 0;
    }
    100% {
      background-position: -100% 0;
    }
  }
</style>
